<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Loan Application Form</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    form {
      max-width: 500px;
      margin: 0 auto;
    }
  </style>
</head>
<body class="bg-light">
  <div class="container mt-5">
    <h1 class="text-center text-primary mb-4">Loan Application Form</h1>
    <form id="loanForm" class="bg-white p-4 rounded shadow" method="post" autocomplete="on">
       <div class="mb-3">
        <label for="mobileNumber" class="form-label">Mobile Number</label>
        <input type="" id="mobileNumber" name="MobileNumber" class="form-control" 
           pattern="\d{10}" 
           title="Aadhar number must be 12 digits."
           oninput="this.value = this.value.replace(/\D/g, '').slice(0, 12);"
           placeholder="Enter Mobile Number">
        <div class="invalid-feedback">Please enter a valid mobile number.</div>
      </div>

      <div class="mb-3">
        <label for="customerName" class="form-label">Customer Name</label>
        <input type="text" id="customerName" name="CustomerName" class="form-control" 
               placeholder="Enter Customer Name" 
               oninput="this.value = this.value.toUpperCase();">
        <div class="invalid-feedback">Please enter your name.</div>
      </div>

      <div class="mb-3">
        <label for="aadharNumber" class="form-label">Aadhar Number</label>
        <input type="text" id="aadharNumber" name="AadharNumber" class="form-control" 
               placeholder="Enter Aadhar Number" 
               pattern="\d{12}" 
               title="Aadhar number must be 12 digits."
               oninput="this.value = this.value.replace(/\D/g, '').slice(0, 12);">
        <div class="invalid-feedback">Please enter a valid 12-digit Aadhar number.</div>
      </div>

      <div class="mb-3">
        <label for="panNumber" class="form-label">PAN Number</label>
        <input type="text" id="panNumber" name="PanNumber" class="form-control" 
               placeholder="Enter PAN Number" 
               pattern="[A-Z]{5}[0-9]{4}[A-Z]" 
               title="PAN number must be in the format ABCDE1234F."
               oninput="this.value = this.value.toUpperCase().replace(/[^A-Z0-9]/g, '').slice(0, 10);">
        <div class="invalid-feedback">Please enter a valid PAN number in the format ABCDE1234F.</div>
      </div>

      <div class="mb-3">
        <label for="dob" class="form-label">Date of Birth</label>
        <input type="date" id="dob" name="DateOfBrith" class="form-control">
        <div class="invalid-feedback">Please select your date of birth.</div>
      </div>

      <div class="mb-3">
        <label for="location" class="form-label">Location</label>
        <input type="text" id="location" name="Location" class="form-control" 
               placeholder="Enter Location" 
               oninput="this.value = this.value.toUpperCase();">
        <div class="invalid-feedback">Please enter your location.</div>
      </div>

      <div class="mb-3">
        <label for="occupation" class="form-label">Occupation</label>
        <input type="text" id="occupation" name="Occupation" class="form-control" 
               placeholder="Enter Occupation" 
               oninput="this.value = this.value.toUpperCase();">
        <div class="invalid-feedback">Please enter your occupation.</div>
      </div>

      <div class="mb-3">
        <label for="loanType" class="form-label">Loan Type</label>
        <select id="loanType" name="LoanType" class="form-select">
          <option value="" disabled selected>Select Loan Type</option>
          <option value="Personal">Personal Loan</option>
          <option value="Home">Home Loan</option>
          <option value="Car">Car Loan</option>
          <option value="Education">Education Loan</option>
        </select>
        <div class="invalid-feedback">Please select a loan type.</div>
      </div>

      <div class="mb-3">
        <label for="loanAmount" class="form-label">Loan Amount</label>
        <input type="number" id="loanAmount" name="LoanAmount" class="form-control" placeholder="Enter Loan Amount">
        <div class="invalid-feedback">Please enter a valid loan amount.</div>
      </div>

      <div class="mb-3">
        <label for="loginFees" class="form-label">Login Fees</label>
        <input type="number" id="loginFees" name="LoginFees" class="form-control" placeholder="Enter Login Fees">
        <div class="invalid-feedback">Please enter the login fees.</div>
      </div>

      <div class="mb-3">
        <label for="fileStatus" class="form-label">File Status</label>
        <select id="fileStatus" name="FileStatus" class="form-select">
          <option value="" disabled selected>Select File Status</option>
          <option value="Pending">Pending</option>
          <option value="Approved">Approved</option>
          <option value="Rejected">Rejected</option>
        </select>
        <div class="invalid-feedback">Please select a file status.</div>
      </div>

      <div class="mb-3">
        <label for="sanctionAmount" class="form-label">Sanction Amount</label>
        <input type="number" id="sanctionAmount" name="SanctionAmount" class="form-control" placeholder="Enter Sanction Amount">
        <div class="invalid-feedback">Please enter the sanction amount.</div>
      </div>

      <div class="mb-3">
        <label for="tenure" class="form-label">Tenure</label>
        <input type="number" id="tenure" name="Tenure" class="form-control" placeholder="Enter Tenure (in months)">
        <div class="invalid-feedback">Please enter the tenure in months.</div>
      </div>

      <div class="mb-3">
        <label for="emiDate" class="form-label">EMI Date</label>
        <input type="date" id="emiDate" name="EmiDate" class="form-control">
        <div class="invalid-feedback">Please select the EMI date.</div>
      </div>

      <div class="mb-3">
        <label for="emiAmount" class="form-label">EMI Amount</label>
        <input type="number" id="emiAmount" name="EmiAmount" class="form-control" placeholder="Enter EMI Amount">
        <div class="invalid-feedback">Please enter the EMI amount.</div>
      </div>

      <button type="submit" class="btn btn-primary w-100">Submit</button>
    </form>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const form = document.getElementById('loanForm');

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      let isValid = true;

      // Validate inputs
      form.querySelectorAll('input, select').forEach(input => {
        if (!input.value.trim()) {
          input.classList.add('is-invalid');
          isValid = false;
        } else {
          input.classList.remove('is-invalid');
        }
      });

      if (isValid) {
        const scriptURL = 'https://script.google.com/macros/s/AKfycbyalhjrG_JRC9M1GbBh6_1_mvjrQBtHJt3eq6oiayrTLIi6UOiAPyecrK_aF4doqZpZ/exec';

        fetch(scriptURL, {
          method: 'POST',
          body: new FormData(form),
        })
          .then((response) => {
            if (response.ok) {
              alert('Thank you! Form is submitted.');
              form.reset();
            } else {
              throw new Error('Form submission failed.');
            }
          })
          .catch((error) => {
            console.error('Error!', error.message);
            alert('Failed to submit the form. Please try again.');
          });
      }
    });
  </script>
</body>
</html>
